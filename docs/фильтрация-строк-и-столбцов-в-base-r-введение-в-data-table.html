<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4 Фильтрация строк и столбцов в base R. Введение в data.table | АнДан 2021: стартовая программа</title>
  <meta name="description" content="4 Фильтрация строк и столбцов в base R. Введение в data.table | АнДан 2021: стартовая программа" />
  <meta name="generator" content="bookdown 0.22 and GitBook 2.6.7" />

  <meta property="og:title" content="4 Фильтрация строк и столбцов в base R. Введение в data.table | АнДан 2021: стартовая программа" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4 Фильтрация строк и столбцов в base R. Введение в data.table | АнДан 2021: стартовая программа" />
  
  
  

<meta name="author" content="А. Ангельгардт, М. Серветник, Ю. Мартысенко, А. Котликова" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="введение-в-r.html"/>
<link rel="next" href="cтатистические-критерии-корреляции.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/pagedtable-1.1/css/pagedtable.css" rel="stylesheet" />
<script src="libs/pagedtable-1.1/js/pagedtable.js"></script>
<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">2021 Андан стартовая</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> О курсе</a></li>
<li class="chapter" data-level="2" data-path="знакомство-с-rstudio.html"><a href="знакомство-с-rstudio.html"><i class="fa fa-check"></i><b>2</b> Знакомство с RStudio</a>
<ul>
<li class="chapter" data-level="2.1" data-path="знакомство-с-rstudio.html"><a href="знакомство-с-rstudio.html#знакомство-с-rstudio-1"><i class="fa fa-check"></i><b>2.1</b> Знакомство с RStudio</a></li>
<li class="chapter" data-level="2.2" data-path="знакомство-с-rstudio.html"><a href="знакомство-с-rstudio.html#горячие-клавиши"><i class="fa fa-check"></i><b>2.2</b> Горячие клавиши</a></li>
<li class="chapter" data-level="2.3" data-path="знакомство-с-rstudio.html"><a href="знакомство-с-rstudio.html#гайды-по-стилю-r"><i class="fa fa-check"></i><b>2.3</b> Гайды по стилю R</a></li>
<li class="chapter" data-level="2.4" data-path="знакомство-с-rstudio.html"><a href="знакомство-с-rstudio.html#рабочая-папка"><i class="fa fa-check"></i><b>2.4</b> Рабочая папка</a></li>
<li class="chapter" data-level="2.5" data-path="знакомство-с-rstudio.html"><a href="знакомство-с-rstudio.html#открываем-файл"><i class="fa fa-check"></i><b>2.5</b> Открываем файл</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="введение-в-r.html"><a href="введение-в-r.html"><i class="fa fa-check"></i><b>3</b> Введение в R</a>
<ul>
<li class="chapter" data-level="3.1" data-path="введение-в-r.html"><a href="введение-в-r.html#общее"><i class="fa fa-check"></i><b>3.1</b> Общее</a></li>
<li class="chapter" data-level="3.2" data-path="введение-в-r.html"><a href="введение-в-r.html#типы-данных"><i class="fa fa-check"></i><b>3.2</b> Типы данных</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="введение-в-r.html"><a href="введение-в-r.html#целое-число-integer"><i class="fa fa-check"></i><b>3.2.1</b> Целое число — integer</a></li>
<li class="chapter" data-level="3.2.2" data-path="введение-в-r.html"><a href="введение-в-r.html#число-с-плавающей-точкой-double"><i class="fa fa-check"></i><b>3.2.2</b> Число с плавающей точкой — double</a></li>
<li class="chapter" data-level="3.2.3" data-path="введение-в-r.html"><a href="введение-в-r.html#комплексные-числа-complex"><i class="fa fa-check"></i><b>3.2.3</b> Комплексные числа — complex</a></li>
<li class="chapter" data-level="3.2.4" data-path="введение-в-r.html"><a href="введение-в-r.html#символьный-тип-данных-строки-character"><i class="fa fa-check"></i><b>3.2.4</b> Символьный тип данных (строки) — character</a></li>
<li class="chapter" data-level="3.2.5" data-path="введение-в-r.html"><a href="введение-в-r.html#фактор-factor"><i class="fa fa-check"></i><b>3.2.5</b> Фактор — factor</a></li>
<li class="chapter" data-level="3.2.6" data-path="введение-в-r.html"><a href="введение-в-r.html#упорядоченный-фактор-ordered-factor"><i class="fa fa-check"></i><b>3.2.6</b> Упорядоченный фактор — ordered factor</a></li>
<li class="chapter" data-level="3.2.7" data-path="введение-в-r.html"><a href="введение-в-r.html#логические-boolean"><i class="fa fa-check"></i><b>3.2.7</b> Логические — boolean</a></li>
<li class="chapter" data-level="3.2.8" data-path="введение-в-r.html"><a href="введение-в-r.html#даты"><i class="fa fa-check"></i><b>3.2.8</b> Даты</a></li>
<li class="chapter" data-level="3.2.9" data-path="введение-в-r.html"><a href="введение-в-r.html#пропущенные-значения-missing-values"><i class="fa fa-check"></i><b>3.2.9</b> Пропущенные значения — missing values</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="введение-в-r.html"><a href="введение-в-r.html#структуры-данных"><i class="fa fa-check"></i><b>3.3</b> Структуры данных</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="введение-в-r.html"><a href="введение-в-r.html#вектор"><i class="fa fa-check"></i><b>3.3.1</b> Вектор</a></li>
<li class="chapter" data-level="3.3.2" data-path="введение-в-r.html"><a href="введение-в-r.html#матрицы"><i class="fa fa-check"></i><b>3.3.2</b> Матрицы</a></li>
<li class="chapter" data-level="3.3.3" data-path="введение-в-r.html"><a href="введение-в-r.html#списки"><i class="fa fa-check"></i><b>3.3.3</b> Списки</a></li>
<li class="chapter" data-level="3.3.4" data-path="введение-в-r.html"><a href="введение-в-r.html#дата-фреймы"><i class="fa fa-check"></i><b>3.3.4</b> Дата фреймы</a></li>
<li class="chapter" data-level="3.3.5" data-path="введение-в-r.html"><a href="введение-в-r.html#другие"><i class="fa fa-check"></i><b>3.3.5</b> Другие</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="введение-в-r.html"><a href="введение-в-r.html#функции-и-простые-действия-с-данными"><i class="fa fa-check"></i><b>3.4</b> Функции и простые действия с данными</a></li>
<li class="chapter" data-level="3.5" data-path="введение-в-r.html"><a href="введение-в-r.html#задания-для-тренировки"><i class="fa fa-check"></i><b>3.5</b> Задания для тренировки</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><i class="fa fa-check"></i><b>4</b> Фильтрация строк и столбцов в base R. Введение в data.table</a>
<ul>
<li class="chapter" data-level="4.1" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#фильтрация-строк-и-столбцов-в-base-r"><i class="fa fa-check"></i><b>4.1</b> Фильтрация строк и столбцов в base R</a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#фильтрация-вектора-по-условию"><i class="fa fa-check"></i><b>4.1.1</b> Фильтрация вектора по условию</a></li>
<li class="chapter" data-level="4.1.2" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#фильтрация-дата.фрейма-по-условию"><i class="fa fa-check"></i><b>4.1.2</b> Фильтрация дата.фрейма по условию</a></li>
<li class="chapter" data-level="4.1.3" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#фильтрация-по-результату-функции"><i class="fa fa-check"></i><b>4.1.3</b> Фильтрация по результату функции</a></li>
<li class="chapter" data-level="4.1.4" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#фильтрация-для-группировки"><i class="fa fa-check"></i><b>4.1.4</b> Фильтрация для группировки</a></li>
<li class="chapter" data-level="4.1.5" data-path="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#введение-в-data.table"><i class="fa fa-check"></i><b>4.1.5</b> Введение в data.table</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html"><i class="fa fa-check"></i><b>5</b> Cтатистические критерии, корреляции</a>
<ul>
<li class="chapter" data-level="5.1" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#введение"><i class="fa fa-check"></i><b>5.1</b> Введение</a></li>
<li class="chapter" data-level="5.2" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#goodness-of-fit-tests"><i class="fa fa-check"></i><b>5.2</b> Goodness-of-fit tests</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#биномиальный-критерий"><i class="fa fa-check"></i><b>5.2.1</b> Биномиальный критерий</a></li>
<li class="chapter" data-level="5.2.2" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#критерий-хи-квадрат"><i class="fa fa-check"></i><b>5.2.2</b> Критерий Хи-квадрат</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#тестирование-взаимосвязи-между-двумя-категориальными-переменными"><i class="fa fa-check"></i><b>5.3</b> Тестирование взаимосвязи между двумя категориальными переменными</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#таблицы-сопряжённости"><i class="fa fa-check"></i><b>5.3.1</b> таблицы сопряжённости</a></li>
<li class="chapter" data-level="5.3.2" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#тест-фишера"><i class="fa fa-check"></i><b>5.3.2</b> Тест Фишера</a></li>
<li class="chapter" data-level="5.3.3" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#добавляем-хи-квадрат"><i class="fa fa-check"></i><b>5.3.3</b> Добавляем Хи-квадрат</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#критерии-для-порядковых-или-ненормально-распределённых-переменных"><i class="fa fa-check"></i><b>5.4</b> Критерии для порядковых или ненормально распределённых переменных</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#тест-манна-уитни"><i class="fa fa-check"></i><b>5.4.1</b> Тест Манна-Уитни</a></li>
<li class="chapter" data-level="5.4.2" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#t-критерий-вилкоксона-для-зависимых-выборок"><i class="fa fa-check"></i><b>5.4.2</b> T-критерий Вилкоксона для зависимых выборок</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#сравнение-средних"><i class="fa fa-check"></i><b>5.5</b> Сравнение средних</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#t-критерий-стьюдента-для-независимых-выборок"><i class="fa fa-check"></i><b>5.5.1</b> t-критерий Стьюдента для независимых выборок</a></li>
<li class="chapter" data-level="5.5.2" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#t-критерий-стьюдента-для-зависимых-выборок"><i class="fa fa-check"></i><b>5.5.2</b> t-критерий Стьюдента для зависимых выборок</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#коэффициенты-корреляции"><i class="fa fa-check"></i><b>5.6</b> Коэффициенты корреляции</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#корреляция-пирсона"><i class="fa fa-check"></i><b>5.6.1</b> Корреляция Пирсона</a></li>
<li class="chapter" data-level="5.6.2" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#ранговые-коэффициенты-спирман-и-кендалл"><i class="fa fa-check"></i><b>5.6.2</b> Ранговые коэффициенты: Спирман и Кендалл</a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="cтатистические-критерии-корреляции.html"><a href="cтатистические-критерии-корреляции.html#бонус-визуализация-корреляционной-матрицы"><i class="fa fa-check"></i><b>5.7</b> Бонус: визуализация корреляционной матрицы</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html"><i class="fa fa-check"></i><b>6</b> Продолжаем с data.table</a>
<ul>
<li class="chapter" data-level="6.1" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#продолжаем-с-data.table-1"><i class="fa fa-check"></i><b>6.1</b> Продолжаем с data.table</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#счёт-элементов-с-помощью-.n"><i class="fa fa-check"></i><b>6.1.1</b> Счёт элементов с помощью .N</a></li>
<li class="chapter" data-level="6.1.2" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#несколько-группировок"><i class="fa fa-check"></i><b>6.1.2</b> Несколько группировок</a></li>
<li class="chapter" data-level="6.1.3" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#несколько-выражений"><i class="fa fa-check"></i><b>6.1.3</b> Несколько выражений</a></li>
<li class="chapter" data-level="6.1.4" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#имена-колонок"><i class="fa fa-check"></i><b>6.1.4</b> Имена колонок</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#указание-имён-при-создании-колонок"><i class="fa fa-check"></i><b>6.2</b> Указание имён при создании колонок</a></li>
<li class="chapter" data-level="6.3" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#вечер-в-хату-вектор-в-colnames"><i class="fa fa-check"></i><b>6.3</b> Вечер в хату, вектор в <code>colnames()</code></a></li>
<li class="chapter" data-level="6.4" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#setnames-из-библиотеки-data.table"><i class="fa fa-check"></i><b>6.4</b> <code>setnames()</code> из библиотеки <code>data.table</code></a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="продолжаем-с-data-table.html"><a href="продолжаем-с-data-table.html#новый-дата.тейбл-или-колонка-в-существующем"><i class="fa fa-check"></i><b>6.4.1</b> Новый дата.тейбл или колонка в существующем?</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html"><i class="fa fa-check"></i><b>7</b> Визуализация данных с <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="7.1" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#визуализация-это-зачем"><i class="fa fa-check"></i><b>7.1</b> Визуализация это зачем?</a></li>
<li class="chapter" data-level="7.2" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#философия-a-layered-grammar-of-graphics"><i class="fa fa-check"></i><b>7.2</b> Философия A Layered Grammar of Graphics</a></li>
<li class="chapter" data-level="7.3" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#экшон"><i class="fa fa-check"></i><b>7.3</b> Экшон</a>
<ul>
<li class="chapter" data-level="7.3.1" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#пакеты"><i class="fa fa-check"></i><b>7.3.1</b> Пакеты</a></li>
<li class="chapter" data-level="7.3.2" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#данные"><i class="fa fa-check"></i><b>7.3.2</b> Данные</a></li>
<li class="chapter" data-level="7.3.3" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#строим-базовый-график"><i class="fa fa-check"></i><b>7.3.3</b> Строим базовый график</a></li>
<li class="chapter" data-level="7.3.4" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#ищем-более-сложные-закономерности"><i class="fa fa-check"></i><b>7.3.4</b> Ищем более сложные закономерности</a></li>
<li class="chapter" data-level="7.3.5" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#важное-замечание-о-визуализации"><i class="fa fa-check"></i><b>7.3.5</b> Важное замечание о визуализации</a></li>
<li class="chapter" data-level="7.3.6" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#инструменты-встроенной-статистической-обработки"><i class="fa fa-check"></i><b>7.3.6</b> Инструменты встроенной статистической обработки</a></li>
<li class="chapter" data-level="7.3.7" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#настраиваем-график"><i class="fa fa-check"></i><b>7.3.7</b> Настраиваем график</a></li>
<li class="chapter" data-level="7.3.8" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#сохранение-графиков"><i class="fa fa-check"></i><b>7.3.8</b> Сохранение графиков</a></li>
</ul></li>
<li class="chapter" data-level="7.4" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#файнал-босс"><i class="fa fa-check"></i><b>7.4</b> Файнал босс</a></li>
<li class="chapter" data-level="7.5" data-path="визуализация-данных-с-ggplot2.html"><a href="визуализация-данных-с-ggplot2.html#конклюжон"><i class="fa fa-check"></i><b>7.5</b> Конклюжон</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html"><i class="fa fa-check"></i><b>8</b> Слияние и преобразование табличных данных</a>
<ul>
<li class="chapter" data-level="8.1" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#слияние-и-преобразование-табличных-данных-1"><i class="fa fa-check"></i><b>8.1</b> Слияние и преобразование табличных данных</a>
<ul>
<li class="chapter" data-level="8.1.1" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#соединение-двух-таблиц-в-одну-простой-случай."><i class="fa fa-check"></i><b>8.1.1</b> Соединение двух таблиц в одну: простой случай.</a></li>
<li class="chapter" data-level="8.1.2" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#merge-и-четыре-разных-соединения"><i class="fa fa-check"></i><b>8.1.2</b> <code>merge()</code> и четыре разных соединения</a></li>
<li class="chapter" data-level="8.1.3" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#inner-join"><i class="fa fa-check"></i><b>8.1.3</b> Inner join</a></li>
<li class="chapter" data-level="8.1.4" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#outer-join"><i class="fa fa-check"></i><b>8.1.4</b> Outer join</a></li>
<li class="chapter" data-level="8.1.5" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#left-join"><i class="fa fa-check"></i><b>8.1.5</b> Left join</a></li>
<li class="chapter" data-level="8.1.6" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#right-join"><i class="fa fa-check"></i><b>8.1.6</b> Right join</a></li>
<li class="chapter" data-level="8.1.7" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#широкие-или-длинные-данные"><i class="fa fa-check"></i><b>8.1.7</b> Широкие или длинные данные</a></li>
<li class="chapter" data-level="8.1.8" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#из-широких-в-длинные-melt"><i class="fa fa-check"></i><b>8.1.8</b> Из широких в длинные: <code>melt()</code></a></li>
<li class="chapter" data-level="8.1.9" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#качественные-вина"><i class="fa fa-check"></i><b>8.1.9</b> Качественные вина</a></li>
<li class="chapter" data-level="8.1.10" data-path="слияние-и-преобразование-табличных-данных.html"><a href="слияние-и-преобразование-табличных-данных.html#из-длинных-в-широкие-dcast"><i class="fa fa-check"></i><b>8.1.10</b> Из длинных в широкие: <code>dcast()</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html"><i class="fa fa-check"></i><b>9</b> ANOVA a.k.a. Дисперсионный анализ</a>
<ul>
<li class="chapter" data-level="9.1" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#зачем-нужен-дисперсионный-анализ"><i class="fa fa-check"></i><b>9.1</b> Зачем нужен дисперсионный анализ?</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#проблема-множественных-сравнений"><i class="fa fa-check"></i><b>9.1.1</b> Проблема множественных сравнений</a></li>
<li class="chapter" data-level="9.1.2" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#идея-дисперсионного-анализа"><i class="fa fa-check"></i><b>9.1.2</b> Идея дисперсионного анализа</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#однофакторный-дисперсионный-анализ"><i class="fa fa-check"></i><b>9.2</b> Однофакторный дисперсионный анализ</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#структура-изменчивости"><i class="fa fa-check"></i><b>9.2.1</b> Структура изменчивости</a></li>
<li class="chapter" data-level="9.2.2" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#тестирование-значимости-фактора"><i class="fa fa-check"></i><b>9.2.2</b> Тестирование значимости фактора</a></li>
<li class="chapter" data-level="9.2.3" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#данные-1"><i class="fa fa-check"></i><b>9.2.3</b> Данные</a></li>
<li class="chapter" data-level="9.2.4" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#дисперсионный-анализ-в-r"><i class="fa fa-check"></i><b>9.2.4</b> Дисперсионный анализ в R</a></li>
<li class="chapter" data-level="9.2.5" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#post-hoc-тесты"><i class="fa fa-check"></i><b>9.2.5</b> Post hoc тесты</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#многофакторный-дисперсионный-анализ"><i class="fa fa-check"></i><b>9.3</b> Многофакторный дисперсионный анализ</a></li>
<li class="chapter" data-level="9.4" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#многофакторный-дисперсионный-анализ-без-взаимодействия-в-r"><i class="fa fa-check"></i><b>9.4</b> Многофакторный дисперсионный анализ без взаимодействия в R</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#многофакторный-дисперсионный-анализ-со-взаимодействием-в-r"><i class="fa fa-check"></i><b>9.4.1</b> Многофакторный дисперсионный анализ со взаимодействием в R</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#важность-аггрегации-данных"><i class="fa fa-check"></i><b>9.5</b> Важность аггрегации данных</a></li>
<li class="chapter" data-level="9.6" data-path="anova-a-k-a-дисперсионный-анализ.html"><a href="anova-a-k-a-дисперсионный-анализ.html#итоги"><i class="fa fa-check"></i><b>9.6</b> Итоги</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html"><i class="fa fa-check"></i><b>10</b> Регрессионный анализ</a>
<ul>
<li class="chapter" data-level="10.1" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#введение-1"><i class="fa fa-check"></i><b>10.1</b> Введение</a></li>
<li class="chapter" data-level="10.2" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#парная-линейная-регрессия"><i class="fa fa-check"></i><b>10.2</b> Парная линейная регрессия</a></li>
<li class="chapter" data-level="10.3" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#мотематика"><i class="fa fa-check"></i><b>10.3</b> Мотематика</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#а-как-это-будет-в-r"><i class="fa fa-check"></i><b>10.3.1</b> А как это будет в R</a></li>
<li class="chapter" data-level="10.3.2" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#подставляем-значения-в-формулу-регрессии"><i class="fa fa-check"></i><b>10.3.2</b> Подставляем значения в формулу регрессии</a></li>
<li class="chapter" data-level="10.3.3" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#количество-объяснённой-дисперсии"><i class="fa fa-check"></i><b>10.3.3</b> Количество объяснённой дисперсии</a></li>
<li class="chapter" data-level="10.3.4" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#посмотреть-на-остатки"><i class="fa fa-check"></i><b>10.3.4</b> Посмотреть на остатки</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#другие-виды-предикторов-и-их-комбинации"><i class="fa fa-check"></i><b>10.4</b> Другие виды предикторов и их комбинации</a>
<ul>
<li class="chapter" data-level="10.4.1" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#категориальный-предиктор"><i class="fa fa-check"></i><b>10.4.1</b> Категориальный предиктор</a></li>
<li class="chapter" data-level="10.4.2" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#количественный-и-категориальный-предиктор-вместе"><i class="fa fa-check"></i><b>10.4.2</b> Количественный и категориальный предиктор вместе</a></li>
</ul></li>
<li class="chapter" data-level="10.5" data-path="регрессионный-анализ.html"><a href="регрессионный-анализ.html#два-количественных-предиктора"><i class="fa fa-check"></i><b>10.5</b> Два количественных предиктора</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">АнДан 2021: стартовая программа</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="фильтрация-строк-и-столбцов-в-base-r.-введение-в-data.table" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Фильтрация строк и столбцов в base R. Введение в data.table</h1>
<div class="sourceCode" id="cb281"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb281-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb281-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code></pre></div>
<div id="фильтрация-строк-и-столбцов-в-base-r" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Фильтрация строк и столбцов в base R</h2>
<p>Из прошлой главы вы узнали, как вообще выглядит RStudio, какие звери (в смысле, типы и структуры данных) в нём обитают, и даже научились фильтровать элементы векторов и дата.фреймов по индексам и по именам. Но есть ещё один очень важный способ фильтрации - это фильтрация по условию.</p>
<div id="фильтрация-вектора-по-условию" class="section level3" number="4.1.1">
<h3><span class="header-section-number">4.1.1</span> Фильтрация вектора по условию</h3>
<p>Фильтрация по условию нужна, когда вы хотите выбрать только ту часть данных, которая удовлетворяет какое-нибудь (вы не поверите) условие. Например: ваш коллега провёл эксперимент и записал возраста всех ваших испытуемых в вектор. Теперь вы хотите посчитать средний возраст испытуемых, чтобы описать его в методах будущей великой статьи, но вот незадача для исследовательского вопроса вам подходят только те, кому больше 18 и меньше 45, а ваш коллега записывал возраста всех, кто пришёл. Так что надо найти в этом векторе тех, кто слишком млад или слишком стар, и исключить их, а уж потом считать хоть среднее, хоть медиану, хоть дисперсию.</p>
<p>Давайте для начала создадим вектор возрастов (я придумала их из головы).</p>
<div class="sourceCode" id="cb282"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb282-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb282-1" aria-hidden="true" tabindex="-1"></a>ages <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">25</span>, <span class="dv">69</span>, <span class="dv">23</span>, <span class="dv">27</span>, <span class="dv">32</span>, <span class="dv">45</span>, <span class="dv">21</span>, <span class="dv">16</span>, <span class="dv">19</span>, <span class="dv">17</span>, <span class="dv">20</span>, <span class="dv">55</span>, <span class="dv">27</span>, <span class="dv">18</span>, <span class="dv">16</span>, <span class="dv">39</span>, <span class="dv">14</span>)</span></code></pre></div>
<p>Чтобы найти, где в нашем векторе люди, которым больше 45, мы можем воспользоваться логическим оператором “больше”:</p>
<div class="sourceCode" id="cb283"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb283-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb283-1" aria-hidden="true" tabindex="-1"></a>ages <span class="sc">&gt;</span> <span class="dv">45</span></span></code></pre></div>
<pre><code>##  [1] FALSE  TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE  TRUE
## [13] FALSE FALSE FALSE FALSE FALSE</code></pre>
<p>Первый TRUE находится на 2 месте в получившемся логическом векторе, так что мы знаем, что седьмой человек в векторе возрастов старше 45. И правда, ему (или ей) 69 лет:</p>
<div class="sourceCode" id="cb285"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb285-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb285-1" aria-hidden="true" tabindex="-1"></a>ages[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>## [1] 69</code></pre>
<p>Но мы же не будем каждый раз вручную искать, где в нашем логическом векторе TRUE? Конечно, не будем! Потому что этот логический вектор можно использовать для фильтрации! Фильтрация с помощью логического вектора работает просто: если на месте элемента в логическом векторе стоит TRUE, мы его включаем, а если FALSE, то не включаем.</p>
<p>Если мы используем логический вектор, который получается в результате команды <code>ages &gt; 45</code>, для фильтрации нашего вектора ages, то получим следующий вектор:</p>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb287-1" aria-hidden="true" tabindex="-1"></a>ages[ages <span class="sc">&gt;</span> <span class="dv">45</span>]</span></code></pre></div>
<pre><code>## [1] 69 55</code></pre>
<p>Упс, кажется, это не то, чего мы хотели! Мы включили все элементы, которые удовлетворяют нашему условию - то есть те, которые <em>больше</em> 45. А нам-то надо, наоборот, оставить тех, кому <em>меньше</em> 45! Давайте это сделаем:</p>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb289-1" aria-hidden="true" tabindex="-1"></a>ages[ages <span class="sc">&lt;</span> <span class="dv">45</span>]</span></code></pre></div>
<pre><code>##  [1] 25 23 27 32 21 16 19 17 20 27 18 16 39 14</code></pre>
<p>Ура! Но подростки всё ещё остались. Что делать с ними? Мы можем соединить сочетание двух логических условий с помощью логического оператора “и” - <code>&amp;</code>. Для начала давайте посмотрим на сам логический вектор, который у нас получается:</p>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb291-1" aria-hidden="true" tabindex="-1"></a>ages <span class="sc">&lt;</span> <span class="dv">45</span> <span class="sc">&amp;</span> ages <span class="sc">&gt;</span> <span class="dv">18</span></span></code></pre></div>
<pre><code>##  [1]  TRUE FALSE  TRUE  TRUE  TRUE FALSE  TRUE FALSE  TRUE FALSE  TRUE FALSE
## [13]  TRUE FALSE FALSE  TRUE FALSE</code></pre>
<p>Логический оператор <code>&amp;</code> возвращает TRUE, только если удовлетворены оба условия - так что теперь в нашем векторе TRUE получили только те испытуемые, возраст которых нам подходит, так что именно их мы и отберём, если используем этот вектор для фильтрации. Вот так счастье! Вот так радость! Давайте же, наконец-то, узнаем средний возраст наших корректных испытуемых:</p>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb293-1" aria-hidden="true" tabindex="-1"></a>correctAges <span class="ot">&lt;-</span> ages[ages <span class="sc">&lt;</span> <span class="dv">45</span> <span class="sc">&amp;</span> ages <span class="sc">&gt;</span> <span class="dv">18</span>]</span>
<span id="cb293-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb293-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(correctAges)</span></code></pre></div>
<pre><code>## [1] 25.88889</code></pre>
<p>Ура!</p>
<p><img src="images/celebration.gif" /></p>
</div>
<div id="фильтрация-дата.фрейма-по-условию" class="section level3" number="4.1.2">
<h3><span class="header-section-number">4.1.2</span> Фильтрация дата.фрейма по условию</h3>
<p>Такую логику фильтрации можно применять не только к векторам, но и к любым табличным данным - например, к матрицам или дата.фреймам.</p>
<p>Давайте загрузим наш дата.фрейм в переменную <code>df</code> (не забудьте указать правильную рабочую директорию - папку, в которой лежит файл у вас на компьютере) и посмотрим, как он выглядит:</p>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb295-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;about_us_eng.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb296-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(df)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    35 obs. of  15 variables:
##  $ height     : int  165 180 161 164 180 170 170 173 163 168 ...
##  $ eye_color  : chr  &quot;green&quot; &quot;brown&quot; &quot;blue&quot; &quot;brown&quot; ...
##  $ eye_number : int  2 2 2 2 2 2 2 2 2 3 ...
##  $ beard      : chr  &quot;no&quot; &quot;no&quot; &quot;no&quot; &quot;no&quot; ...
##  $ soft_drink : chr  &quot;coke&quot; &quot;coke&quot; &quot;no thanks&quot; &quot;coke&quot; ...
##  $ cats       : chr  &quot;this is too personal&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; ...
##  $ gorgeous   : int  10 10 7 10 6 10 8 8 7 9 ...
##  $ siblings   : int  1 2 1 0 1 3 2 1 2 0 ...
##  $ hair_length: int  25 7 20 20 10 20 30 40 30 30 ...
##  $ shoe_size  : num  38 43 38 38 42 39 42 41 38 38 ...
##  $ guitar     : chr  &quot;What is a guitar? A giant ukulele?&quot; &quot;I am a portable speaker with an expanded repertoire of Nashe radio&quot; &quot;I can play one song of Tsoy. The one with the four chords.&quot; &quot;I am a portable speaker with an expanded repertoire of Nashe radio&quot; ...
##  $ hot_drink  : chr  &quot;tea&quot; &quot;shall we dance&quot; &quot;shall we dance&quot; &quot;shall we dance&quot; ...
##  $ month      : chr  &quot;February&quot; &quot;June&quot; &quot;July&quot; &quot;November&quot; ...
##  $ hogwarts   : chr  &quot;Hufflepuff&quot; &quot;Gryffindor&quot; &quot;Slytherin&quot; &quot;Slytherin&quot; ...
##  $ dream      : chr  &quot;rock star&quot; &quot;rock star&quot; &quot;Rick from Rick and Morty&quot; &quot;astronaut&quot; ...</code></pre>
<p>Ага, прекрасно. Например, у нас в датасете есть колонка <code>eye_number</code> - там был вопрос “Сколько у вас глаз?”. Скорее всего, люди, которые ответили, что у них больше двух глаз, или шутники, или шестикрылые серафимы - так или иначе, давайте исключим их из нашего очень серьёзного опроса. Как мы можем это сделать?</p>
<p>Логика здесь совершенно та же, что и в прошлом примере - мы воспользуемся логическим вектором. Для этого нам нужно вспомнить ещё два факта: во-первых, фильтровать дата.фрейм мы можем и по строкам, и по столбцам. Например, вот такая команда выберет только строки с индексами от 1 до 5 (то есть первые пять) и столбцы с индексами от 1 до 10 (то есть первые десять):</p>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb298-1" aria-hidden="true" tabindex="-1"></a>df[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":[""],"name":["_rn_"],"type":[""],"align":["left"]},{"label":["height"],"name":[1],"type":["int"],"align":["right"]},{"label":["eye_color"],"name":[2],"type":["chr"],"align":["left"]},{"label":["eye_number"],"name":[3],"type":["int"],"align":["right"]},{"label":["beard"],"name":[4],"type":["chr"],"align":["left"]},{"label":["soft_drink"],"name":[5],"type":["chr"],"align":["left"]},{"label":["cats"],"name":[6],"type":["chr"],"align":["left"]},{"label":["gorgeous"],"name":[7],"type":["int"],"align":["right"]},{"label":["siblings"],"name":[8],"type":["int"],"align":["right"]},{"label":["hair_length"],"name":[9],"type":["int"],"align":["right"]},{"label":["shoe_size"],"name":[10],"type":["dbl"],"align":["right"]}],"data":[{"1":"165","2":"green","3":"2","4":"no","5":"coke","6":"this is too personal","7":"10","8":"1","9":"25","10":"38","_rn_":"1"},{"1":"180","2":"brown","3":"2","4":"no","5":"coke","6":"1","7":"10","8":"2","9":"7","10":"43","_rn_":"2"},{"1":"161","2":"blue","3":"2","4":"no","5":"no thanks","6":"0","7":"7","8":"1","9":"20","10":"38","_rn_":"3"},{"1":"164","2":"brown","3":"2","4":"no","5":"coke","6":"0","7":"10","8":"0","9":"20","10":"38","_rn_":"4"},{"1":"180","2":"blue","3":"2","4":"no","5":"coke","6":"1","7":"6","8":"1","9":"10","10":"42","_rn_":"5"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Во-вторых, мы можем “вытащить” колонку дата.фрейма и обращаться с ней, как с вектором, с помощью знака доллара, <code>$</code>. Вот такая команда сохранит в переменную <code>eyeNumberVec</code> колонку <code>eye_number</code> наше дата.фрейма <code>df</code>:</p>
<div class="sourceCode" id="cb299"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb299-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb299-1" aria-hidden="true" tabindex="-1"></a>eyeNumberVec <span class="ot">&lt;-</span> df<span class="sc">$</span>eye_number</span>
<span id="cb299-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb299-2" aria-hidden="true" tabindex="-1"></a>eyeNumberVec</span></code></pre></div>
<pre><code>##  [1]   2   2   2   2   2   2   2   2   2   3   2   2   3   2   2   2   2   2   2
## [20]   3   2   2   2   2   2   2   2   2   4 104   2   2   2   2   2</code></pre>
<p>Эту вытащенную колонку мы можем проверить на соответствие нашему условию (не больше двух глаз):</p>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb301-1" aria-hidden="true" tabindex="-1"></a>eyeNumber2Below <span class="ot">&lt;-</span> eyeNumberVec <span class="sc">&lt;=</span> <span class="dv">2</span></span>
<span id="cb301-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb301-2" aria-hidden="true" tabindex="-1"></a>eyeNumber2Below</span></code></pre></div>
<pre><code>##  [1]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE
## [13] FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE FALSE  TRUE  TRUE  TRUE  TRUE
## [25]  TRUE  TRUE  TRUE  TRUE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE</code></pre>
<p>Каждая строка нашего дата.фрейма этот ответ одного респондента на все вопросы. Так что, если мы используем этот вектор, чтобы оставить в нашем дата.фрейме только строки, в которых у респондента не больше двух глаз, то и многоглазых респондентов в нашем дата.фрейме не останется. Это может немного запутать в самом начале: условие у нас для колонки (не больше 2 в колонке <code>eye_number</code>), а убираем мы строки. Раз убираем строки, то и используем наше условие в той части квадратных скобок, где строки. То есть - до запятой.</p>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb303-1" aria-hidden="true" tabindex="-1"></a>dfOnly2Eyes <span class="ot">&lt;-</span> df[eyeNumber2Below,]</span></code></pre></div>
<p>Всё то же самое можно сделать, не создавая промежуточные вектора <code>eyeNumberVec</code> и <code>eyeNumberVecBelow2</code>:</p>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb304-1" aria-hidden="true" tabindex="-1"></a>dfOnly2Eyes <span class="ot">&lt;-</span> df[df<span class="sc">$</span>eye_number <span class="sc">&lt;=</span> <span class="dv">2</span>,]</span></code></pre></div>
<p>Часто мы хотим фильтровать данные по нескольким условиям сразу, зачастую достаточно сложным - например, давайте оставим только гриффиндорцев, у которых или очень короткие волосы (короче 10 см) или очень маленький размер ноги (меньше 38).</p>
<p>Конечно, это всегда можно сделать в два этапа - сначала выбрать гриффиндорцев, а потом из них выбрать коротковолосых или мелконогих:</p>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb305-1" aria-hidden="true" tabindex="-1"></a>dfOnlyGr <span class="ot">&lt;-</span> df[df<span class="sc">$</span>hogwarts <span class="sc">==</span> <span class="st">&quot;Gryffindor&quot;</span>,]</span>
<span id="cb305-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb305-2" aria-hidden="true" tabindex="-1"></a>dfOnlySmallGr <span class="ot">&lt;-</span> dfOnlyGr[dfOnlyGr<span class="sc">$</span>hair_length <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">|</span> dfOnlyGr<span class="sc">$</span>shoe_size <span class="sc">&lt;</span> <span class="dv">38</span>]</span></code></pre></div>
<p>Но у нас в среде останется этот вспомогательный дата.фрейм <code>dfOnlyGr</code>… Давайте лучше соединим оба условия воедино - а чтобы указать, как они между собой соотносятся, воспользуемся круглыми скобкам:</p>
<div class="sourceCode" id="cb306"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb306-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb306-1" aria-hidden="true" tabindex="-1"></a>dfOnlySmallGr <span class="ot">&lt;-</span> df[df<span class="sc">$</span>hogwarts <span class="sc">==</span> <span class="st">&quot;Gryffindor&quot;</span> <span class="sc">&amp;</span></span>
<span id="cb306-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb306-2" aria-hidden="true" tabindex="-1"></a>                      (df<span class="sc">$</span>hair_length <span class="sc">&lt;</span> <span class="dv">10</span> <span class="sc">|</span> df<span class="sc">$</span>shoe_size <span class="sc">&lt;</span> <span class="dv">38</span>),]</span></code></pre></div>
<p>Красота!</p>
<div class="rmdtask">
<p>
Задание: Уберите из дата.фрейма всех подозрительных респондентов - и тех, у кого больше двух глаз, и тех, у кого нереалистичный рост (скажем, меньше, чем 140 см, или больше, чем 220 см), если такие есть, и тех, кто ответил, что они не рождались в вопросе про месяц рождения.
</p>
</div>
<div class="rmdtask">
<p>
Задание: Создайте отдельный дата.фрейм, в котором у нас будут только люди, которые родились зимой или осенью, и попали бы в Хогвартсе или в Слизерин, или в Рейвенкло.
</p>
</div>
</div>
<div id="фильтрация-по-результату-функции" class="section level3" number="4.1.3">
<h3><span class="header-section-number">4.1.3</span> Фильтрация по результату функции</h3>
<p>Иногда мы хотим отфильтровать значения не по абсолютному условию (все респонденты, у которых больше 1 сиблинга), а по относительному (все респонденты, у которых больше сиблингов, чем в среднем в выборке). Чтобы это сделать, мы можем сравнивать значения вектора или колонки дата.фрейма с результатом какой-нибудь функции, например, <code>mean()</code>.</p>
<p>Это можно сделать в две строки, сначала посчитав среднее, а потом использовав его в сравнении:</p>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb307-1" aria-hidden="true" tabindex="-1"></a>meanSibs <span class="ot">&lt;-</span> <span class="fu">mean</span>(df<span class="sc">$</span>siblings)</span>
<span id="cb307-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb307-2" aria-hidden="true" tabindex="-1"></a>dfAboveMeanSibs <span class="ot">&lt;-</span> df[df<span class="sc">$</span>siblings <span class="sc">&gt;</span> meanSibs,]</span></code></pre></div>
<div class="sourceCode" id="cb308"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb308-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb308-1" aria-hidden="true" tabindex="-1"></a>dfAboveMeanSibs <span class="ot">&lt;-</span> df[df<span class="sc">$</span>siblings <span class="sc">&gt;</span> <span class="fu">mean</span>(df<span class="sc">$</span>siblings),]</span></code></pre></div>
</div>
<div id="фильтрация-для-группировки" class="section level3" number="4.1.4">
<h3><span class="header-section-number">4.1.4</span> Фильтрация для группировки</h3>
<p>Часто мы хотим узнать что-нибудь про разные группы людей, которые есть в наших данных. Например, может быть, мы напоили испытуемых кофе, чаем или водой и ожидаем, что в зависимости от напитка они будут хуже или лучше решать задачи - тогда мы хотим посчитать, сколько задач в среднем решили испытуемые из каждой группы. Здесь нам тоже может пригодиться фильтрация.</p>
<p>Давайте узнаем, сколько в средним братьев и сестёр у наших респондентов, которые в Хогвартсе попали бы на разные факультеты. Для этого мы произведём четыре отдельных фильтрации (по одной на каждый факультет), а из колонок выберем только <code>siblings</code>.
(Если вы не помните, как пишутся факультеты, то всегда можно проверить с помощью <code>unique(df$hogwarts)</code> - эта команда вернёт все уникальные значения в векторе).</p>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb309-1" aria-hidden="true" tabindex="-1"></a>siblingsGr <span class="ot">&lt;-</span> df[df<span class="sc">$</span>hogwarts <span class="sc">==</span> <span class="st">&quot;Gryffindor&quot;</span>, <span class="st">&quot;siblings&quot;</span>]</span>
<span id="cb309-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb309-2" aria-hidden="true" tabindex="-1"></a>siblingsRav <span class="ot">&lt;-</span> df[df<span class="sc">$</span>hogwarts <span class="sc">==</span> <span class="st">&quot;Ravenclaw&quot;</span>, <span class="st">&quot;siblings&quot;</span>]</span>
<span id="cb309-3"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb309-3" aria-hidden="true" tabindex="-1"></a>siblingsSl <span class="ot">&lt;-</span> df[df<span class="sc">$</span>hogwarts <span class="sc">==</span> <span class="st">&quot;Slytherin&quot;</span>, <span class="st">&quot;siblings&quot;</span>]</span>
<span id="cb309-4"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb309-4" aria-hidden="true" tabindex="-1"></a>siblingsHuff <span class="ot">&lt;-</span> df[df<span class="sc">$</span>hogwarts <span class="sc">==</span> <span class="st">&quot;Hufflepuff&quot;</span>, <span class="st">&quot;siblings&quot;</span>]</span></code></pre></div>
<p>И теперь можно воспользоваться функцией <code>mean()</code>, чтобы посчитать среднее значение каждого вектора:</p>
<div class="sourceCode" id="cb310"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb310-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb310-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(siblingsGr)</span></code></pre></div>
<pre><code>## [1] 1.333333</code></pre>
<div class="sourceCode" id="cb312"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb312-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb312-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(siblingsRav)</span></code></pre></div>
<pre><code>## [1] 1.214286</code></pre>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb314-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(siblingsSl)</span></code></pre></div>
<pre><code>## [1] 0.8333333</code></pre>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb316-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(siblingsHuff)</span></code></pre></div>
<pre><code>## [1] 0.6666667</code></pre>
<div class="rmdtask">
<p>
Задание: Воспользуйтесь функцией <code>max()</code>, чтобы найти самого высокого человека для каждого уровня игры на гитаре.
</p>
</div>
<p>Такой подход, конечно, не самый эффективный - если у вас всего четыре категории, то ничего страшного, но что если у вас их, например, сто? Сразу хочется как-то это дело автоматизировать, и сейчас мы научимся это делать. Но перед этим я хочу дать вам совет: иногда вы не будете помнить, как что-то сделать эффективно (может быть, на хакатоне в субботу у вас будет такая проблема) - и тогда нет никакого зашквара в том, чтобы сделать, как можете. Эффективный код это прекрасно, но самое прекрасное это код, который работает и делает то, что вам нужно :) Эффективность приходит с опытом, так что пока я бы не советовала переживать о ней слишком сильно.</p>
</div>
<div id="введение-в-data.table" class="section level3" number="4.1.5">
<h3><span class="header-section-number">4.1.5</span> Введение в data.table</h3>
<p>Дата.фрейм это структура данных, которая по умолчанию встроена в R. Но большинство людей в своей реальной работе с данными используют одну из двух внешних библиотек: или <code>data.table</code>, или <code>dplyr</code>. Обе этих библиотеки имеют свою структуру для табличных данных (собственно, <code>data.table</code> в первой, <code>tibble</code> во второй) с расширенным функционалом.
Ходят слухи, что если зайти в чат про R в пятницу вечером, там будут спорить или про R vs. Python, или про data.table vs. dplyr. У каждой библиотеки есть свои сильные и слабые стороны (<code>data.table</code> быстрее и лаконичнее, с <code>dplyr</code> получается более “читаемый” код). Среди организаторов АнДана есть сторонники обеих библиотек (и на Питоне многие из нас тоже пишут, кстати :D). Лично я (Маша) считаю, что важно хорошо знать хотя бы одну - в целом, любую, а со второй, если надо, дальше можно разобраться. В этом курсе мы с вами будем пользоваться <code>data.table</code>.</p>
<p>Итак, как же воспользоваться внешней библиотекой? Для этого вам нужно будет выполнить две команды. Во-первых, библиотеку нужно установить с помощью команды <code>install.packages()</code>. Обратите внимание, что имя библиотеки пишется в кавычках:</p>
<div class="sourceCode" id="cb318"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb318-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb318-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&#39;data.table&#39;</span>)</span></code></pre></div>
<p>Устанавливать библиотеку нужно один раз, и если вы молодечик, то сделали это до школы :)</p>
<p>Во-вторых, библиотеку нужно подгрузить (другими словами, активировать) с помощью команды <code>library()</code>. Это нужно делать в начале каждой рабочей сессии - то есть, каждый раз, когда вы открываете RStudio. Обычно принято декларировать все библиотеки, которые вы используете в скрипте, в самом верху скрипта (если вы проскроллите наверх, то увидите, что я так и сделала). Здесь имя библиотеки пишется без кавычек:</p>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb319-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code></pre></div>
<p>Создать дата.тейбл с нуля можно так же, как и дата.фрейм, только используя функцию <code>data.table()</code>:</p>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb320-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">number =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,</span>
<span id="cb320-2"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb320-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">name =</span> <span class="fu">c</span>(<span class="st">&quot;Masha&quot;</span>, <span class="st">&quot;Sasha&quot;</span>, <span class="st">&quot;Pet&#39;ka&quot;</span>, <span class="st">&quot;Dasha&quot;</span>, <span class="st">&quot;Vladimir Petrovich&quot;</span>))</span></code></pre></div>
<p>Превратить имеющийся дата.фрейм в дата.тейбл - с помощью функции <code>as.data.table()</code>:</p>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb321-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">as.data.table</span>(df)</span></code></pre></div>
<p>А загрузить csv-документ сразу в дата.тейбл можно с помощью функции <code>fread()</code>:</p>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb322-1" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">fread</span>(<span class="st">&quot;about_us_eng.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb323-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(dt)</span></code></pre></div>
<pre><code>## Classes &#39;data.table&#39; and &#39;data.frame&#39;:   35 obs. of  15 variables:
##  $ height     : int  165 180 161 164 180 170 170 173 163 168 ...
##  $ eye_color  : chr  &quot;green&quot; &quot;brown&quot; &quot;blue&quot; &quot;brown&quot; ...
##  $ eye_number : int  2 2 2 2 2 2 2 2 2 3 ...
##  $ beard      : chr  &quot;no&quot; &quot;no&quot; &quot;no&quot; &quot;no&quot; ...
##  $ soft_drink : chr  &quot;coke&quot; &quot;coke&quot; &quot;no thanks&quot; &quot;coke&quot; ...
##  $ cats       : chr  &quot;this is too personal&quot; &quot;1&quot; &quot;0&quot; &quot;0&quot; ...
##  $ gorgeous   : int  10 10 7 10 6 10 8 8 7 9 ...
##  $ siblings   : int  1 2 1 0 1 3 2 1 2 0 ...
##  $ hair_length: int  25 7 20 20 10 20 30 40 30 30 ...
##  $ shoe_size  : num  38 43 38 38 42 39 42 41 38 38 ...
##  $ guitar     : chr  &quot;What is a guitar? A giant ukulele?&quot; &quot;I am a portable speaker with an expanded repertoire of Nashe radio&quot; &quot;I can play one song of Tsoy. The one with the four chords.&quot; &quot;I am a portable speaker with an expanded repertoire of Nashe radio&quot; ...
##  $ hot_drink  : chr  &quot;tea&quot; &quot;shall we dance&quot; &quot;shall we dance&quot; &quot;shall we dance&quot; ...
##  $ month      : chr  &quot;February&quot; &quot;June&quot; &quot;July&quot; &quot;November&quot; ...
##  $ hogwarts   : chr  &quot;Hufflepuff&quot; &quot;Gryffindor&quot; &quot;Slytherin&quot; &quot;Slytherin&quot; ...
##  $ dream      : chr  &quot;rock star&quot; &quot;rock star&quot; &quot;Rick from Rick and Morty&quot; &quot;astronaut&quot; ...
##  - attr(*, &quot;.internal.selfref&quot;)=&lt;externalptr&gt;</code></pre>
<p>На первый взгляд наш дата.тейбл выглядит совершенно так же, как дата.фрейм. Больше скажу - с ним можно делать всё то же самое, что с дата.фреймом - фильтровать строки и колонки по индексам и обращаться к колонкам с помощью <code>$</code>:</p>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb325-1" aria-hidden="true" tabindex="-1"></a>dt[<span class="dv">1</span>,<span class="dv">1</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["height"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"165"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb326-1" aria-hidden="true" tabindex="-1"></a>dt[<span class="dv">1</span>,]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["height"],"name":[1],"type":["int"],"align":["right"]},{"label":["eye_color"],"name":[2],"type":["chr"],"align":["left"]},{"label":["eye_number"],"name":[3],"type":["int"],"align":["right"]},{"label":["beard"],"name":[4],"type":["chr"],"align":["left"]},{"label":["soft_drink"],"name":[5],"type":["chr"],"align":["left"]},{"label":["cats"],"name":[6],"type":["chr"],"align":["left"]},{"label":["gorgeous"],"name":[7],"type":["int"],"align":["right"]},{"label":["siblings"],"name":[8],"type":["int"],"align":["right"]},{"label":["hair_length"],"name":[9],"type":["int"],"align":["right"]},{"label":["shoe_size"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["guitar"],"name":[11],"type":["chr"],"align":["left"]},{"label":["hot_drink"],"name":[12],"type":["chr"],"align":["left"]},{"label":["month"],"name":[13],"type":["chr"],"align":["left"]},{"label":["hogwarts"],"name":[14],"type":["chr"],"align":["left"]},{"label":["dream"],"name":[15],"type":["chr"],"align":["left"]}],"data":[{"1":"165","2":"green","3":"2","4":"no","5":"coke","6":"this is too personal","7":"10","8":"1","9":"25","10":"38","11":"What is a guitar? A giant ukulele?","12":"tea","13":"February","14":"Hufflepuff","15":"rock star"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb327-1" aria-hidden="true" tabindex="-1"></a>dt[,<span class="dv">1</span>]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["height"],"name":[1],"type":["int"],"align":["right"]}],"data":[{"1":"165"},{"1":"180"},{"1":"161"},{"1":"164"},{"1":"180"},{"1":"170"},{"1":"170"},{"1":"173"},{"1":"163"},{"1":"168"},{"1":"165"},{"1":"164"},{"1":"166"},{"1":"NA"},{"1":"173"},{"1":"173"},{"1":"183"},{"1":"170"},{"1":"185"},{"1":"169"},{"1":"185"},{"1":"172"},{"1":"158"},{"1":"185"},{"1":"168"},{"1":"175"},{"1":"162"},{"1":"182"},{"1":"164"},{"1":"167"},{"1":"175"},{"1":"167"},{"1":"168"},{"1":"179"},{"1":"172"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb328-1" aria-hidden="true" tabindex="-1"></a>dt[<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>,]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["height"],"name":[1],"type":["int"],"align":["right"]},{"label":["eye_color"],"name":[2],"type":["chr"],"align":["left"]},{"label":["eye_number"],"name":[3],"type":["int"],"align":["right"]},{"label":["beard"],"name":[4],"type":["chr"],"align":["left"]},{"label":["soft_drink"],"name":[5],"type":["chr"],"align":["left"]},{"label":["cats"],"name":[6],"type":["chr"],"align":["left"]},{"label":["gorgeous"],"name":[7],"type":["int"],"align":["right"]},{"label":["siblings"],"name":[8],"type":["int"],"align":["right"]},{"label":["hair_length"],"name":[9],"type":["int"],"align":["right"]},{"label":["shoe_size"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["guitar"],"name":[11],"type":["chr"],"align":["left"]},{"label":["hot_drink"],"name":[12],"type":["chr"],"align":["left"]},{"label":["month"],"name":[13],"type":["chr"],"align":["left"]},{"label":["hogwarts"],"name":[14],"type":["chr"],"align":["left"]},{"label":["dream"],"name":[15],"type":["chr"],"align":["left"]}],"data":[{"1":"165","2":"green","3":"2","4":"no","5":"coke","6":"this is too personal","7":"10","8":"1","9":"25","10":"38","11":"What is a guitar? A giant ukulele?","12":"tea","13":"February","14":"Hufflepuff","15":"rock star"},{"1":"180","2":"brown","3":"2","4":"no","5":"coke","6":"1","7":"10","8":"2","9":"7","10":"43","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"shall we dance","13":"June","14":"Gryffindor","15":"rock star"},{"1":"161","2":"blue","3":"2","4":"no","5":"no thanks","6":"0","7":"7","8":"1","9":"20","10":"38","11":"I can play one song of Tsoy. The one with the four chords.","12":"shall we dance","13":"July","14":"Slytherin","15":"Rick from Rick and Morty"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb329-1" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>height</span></code></pre></div>
<pre><code>##  [1] 165 180 161 164 180 170 170 173 163 168 165 164 166  NA 173 173 183 170 185
## [20] 169 185 172 158 185 168 175 162 182 164 167 175 167 168 179 172</code></pre>
<p>Но помимо этого у дата.тейблов есть очень крутой дополнительный функционал со своим специфическим синтаксисом. У дата.фрейма в квадратных скобках две части: df[фильтрация строк, фильтрация столбцов]. У дата.тейбла - три, да ещё и смысл второй поменялся: dt[фильтрация строк, выражение, параметр]. Перед первой запятой мы выбираем, какие строки мы хотим оставить в дата.тейбле - и теперь мы можем обращаться к колонкам напрямую, не используя конструкцию типа <code>df$height</code>, дата.тейбл по умолчанию считает, что внутри квадратных скобок вы можете обращаться к колонкам:</p>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb331-1" aria-hidden="true" tabindex="-1"></a>dt[height <span class="sc">&gt;</span> <span class="dv">165</span>, ]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["height"],"name":[1],"type":["int"],"align":["right"]},{"label":["eye_color"],"name":[2],"type":["chr"],"align":["left"]},{"label":["eye_number"],"name":[3],"type":["int"],"align":["right"]},{"label":["beard"],"name":[4],"type":["chr"],"align":["left"]},{"label":["soft_drink"],"name":[5],"type":["chr"],"align":["left"]},{"label":["cats"],"name":[6],"type":["chr"],"align":["left"]},{"label":["gorgeous"],"name":[7],"type":["int"],"align":["right"]},{"label":["siblings"],"name":[8],"type":["int"],"align":["right"]},{"label":["hair_length"],"name":[9],"type":["int"],"align":["right"]},{"label":["shoe_size"],"name":[10],"type":["dbl"],"align":["right"]},{"label":["guitar"],"name":[11],"type":["chr"],"align":["left"]},{"label":["hot_drink"],"name":[12],"type":["chr"],"align":["left"]},{"label":["month"],"name":[13],"type":["chr"],"align":["left"]},{"label":["hogwarts"],"name":[14],"type":["chr"],"align":["left"]},{"label":["dream"],"name":[15],"type":["chr"],"align":["left"]}],"data":[{"1":"180","2":"brown","3":"2","4":"no","5":"coke","6":"1","7":"10","8":"2","9":"7","10":"43.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"shall we dance","13":"June","14":"Gryffindor","15":"rock star"},{"1":"180","2":"blue","3":"2","4":"no","5":"coke","6":"1","7":"6","8":"1","9":"10","10":"42.0","11":"What is a guitar? A giant ukulele?","12":"NA","13":"March","14":"Ravenclaw","15":"princess"},{"1":"170","2":"green","3":"2","4":"no","5":"no thanks","6":"1","7":"10","8":"3","9":"20","10":"39.0","11":"What is a guitar? A giant ukulele?","12":"coffee","13":"January","14":"Slytherin","15":"other"},{"1":"170","2":"brown","3":"2","4":"yes","5":"pepsi","6":"1","7":"8","8":"2","9":"30","10":"42.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"shall we dance","13":"May","14":"Ravenclaw","15":"other"},{"1":"173","2":"brown","3":"2","4":"no","5":"coke","6":"1","7":"8","8":"1","9":"40","10":"41.0","11":"What is a guitar? A giant ukulele?","12":"coffee","13":"November","14":"Slytherin","15":"astronaut"},{"1":"168","2":"green","3":"3","4":"no","5":"no thanks","6":"0","7":"9","8":"0","9":"30","10":"38.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"shall we dance","13":"March","14":"Gryffindor","15":"rock star"},{"1":"166","2":"green","3":"3","4":"no","5":"coke","6":"1","7":"10","8":"1","9":"40","10":"36.0","11":"What is a guitar? A giant ukulele?","12":"coffee","13":"February","14":"Gryffindor","15":"ice cream seller"},{"1":"173","2":"blue","3":"2","4":"no","5":"coke","6":"0","7":"8","8":"0","9":"36","10":"39.0","11":"I am new Jimi Hendrix","12":"coffee","13":"November","14":"Slytherin","15":"rock star"},{"1":"173","2":"green","3":"2","4":"no","5":"no thanks","6":"1","7":"10","8":"1","9":"25","10":"36.0","11":"What is a guitar? A giant ukulele?","12":"tea","13":"May","14":"Ravenclaw","15":"astronaut"},{"1":"183","2":"brown","3":"2","4":"no","5":"coke","6":"1","7":"8","8":"1","9":"22","10":"43.0","11":"I can play one song of Tsoy. The one with the four chords.","12":"coffee","13":"August","14":"Hufflepuff","15":"princess"},{"1":"170","2":"brown","3":"2","4":"no","5":"no thanks","6":"this is too personal","7":"7","8":"1","9":"5","10":"40.0","11":"What is a guitar? A giant ukulele?","12":"shall we dance","13":"May","14":"Hufflepuff","15":"other"},{"1":"185","2":"brown","3":"2","4":"no","5":"coke","6":"0","7":"3","8":"1","9":"5","10":"45.0","11":"I can play one song of Tsoy. The one with the four chords.","12":"coffee","13":"May","14":"Hufflepuff","15":"astronaut"},{"1":"169","2":"brown","3":"3","4":"yes","5":"pepsi","6":"1","7":"10","8":"1","9":"21","10":"39.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"shall we dance","13":"I was never born","14":"Ravenclaw","15":"princess"},{"1":"185","2":"brown","3":"2","4":"no","5":"coke","6":"0","7":"6","8":"0","9":"5","10":"45.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"coffee","13":"June","14":"Ravenclaw","15":"trolleybus or tram driver"},{"1":"172","2":"brown","3":"2","4":"no","5":"no thanks","6":"0","7":"4","8":"0","9":"30","10":"41.0","11":"What is a guitar? A giant ukulele?","12":"tea","13":"February","14":"Hufflepuff","15":"other"},{"1":"185","2":"brown","3":"2","4":"no","5":"no thanks","6":"0","7":"3","8":"0","9":"11","10":"43.0","11":"I can play one song of Tsoy. The one with the four chords.","12":"tea","13":"March","14":"Gryffindor","15":"other"},{"1":"168","2":"brown","3":"2","4":"no","5":"no thanks","6":"1","7":"9","8":"1","9":"40","10":"35.0","11":"What is a guitar? A giant ukulele?","12":"tea","13":"February","14":"Gryffindor","15":"other"},{"1":"175","2":"blue","3":"2","4":"no","5":"pepsi","6":"2","7":"10","8":"0","9":"20","10":"40.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"coffee","13":"October","14":"Ravenclaw","15":"princess"},{"1":"182","2":"other","3":"2","4":"no","5":"coke","6":"1","7":"10","8":"0","9":"12","10":"43.0","11":"What is a guitar? A giant ukulele?","12":"tea","13":"I was never born","14":"Hufflepuff","15":"other"},{"1":"167","2":"green","3":"104","4":"no","5":"coke","6":"2","7":"7","8":"5","9":"15","10":"39.0","11":"What is a guitar? A giant ukulele?","12":"coffee","13":"December","14":"Ravenclaw","15":"other"},{"1":"175","2":"blue","3":"2","4":"no","5":"pepsi","6":"2","7":"10","8":"0","9":"20","10":"40.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"coffee","13":"October","14":"Ravenclaw","15":"princess"},{"1":"167","2":"brown","3":"2","4":"no","5":"coke","6":"0","7":"9","8":"1","9":"25","10":"38.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"tea","13":"September","14":"Ravenclaw","15":"rock star"},{"1":"168","2":"blue","3":"2","4":"no","5":"coke","6":"0","7":"8","8":"0","9":"15","10":"40.5","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"coffee","13":"January","14":"Ravenclaw","15":"Rick from Rick and Morty"},{"1":"179","2":"blue","3":"2","4":"yes","5":"coke","6":"0","7":"7","8":"5","9":"35","10":"43.0","11":"I am a portable speaker with an expanded repertoire of Nashe radio","12":"coffee","13":"September","14":"Gryffindor","15":"astronaut"},{"1":"172","2":"green","3":"2","4":"no","5":"coke","6":"2","7":"7","8":"1","9":"30","10":"39.0","11":"I can play one song of Tsoy. The one with the four chords.","12":"tea","13":"December","14":"Ravenclaw","15":"trolleybus or tram driver"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<p>Между первой и второй запятой мы уточняем, что мы хотим сделать с колонками. Мы можем просто выбрать одну колонку и “достать” только её:</p>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb332-1" aria-hidden="true" tabindex="-1"></a>dt[height <span class="sc">&gt;</span> <span class="dv">165</span>, eye_number]</span></code></pre></div>
<pre><code>##  [1]   2   2   2   2   2   3   3   2   2   2   2   2   3   2   2   2   2   2   2
## [20] 104   2   2   2   2   2</code></pre>
<p>Можем выбрать колонку и произвести над ней какую-нибудь операцию:</p>
<div class="sourceCode" id="cb334"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb334-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb334-1" aria-hidden="true" tabindex="-1"></a>dt[height <span class="sc">&gt;</span> <span class="dv">165</span>, <span class="fu">max</span>(eye_number)]</span></code></pre></div>
<pre><code>## [1] 104</code></pre>
<p>В предыдущей команде мы <em>сначала</em> выбрали только те строки (= респондентов), которые выше 165 см, а потом узнали, какое среди них максимальное число глаз.</p>
<p>А можем создать новую колонку внутри нашего дата.тейбла. Для этого мы будем использовать новый оператор, <code>:=</code> (Владимир Львович Волохонский называет его “приписька”. Живите теперь тоже с этим знанием):</p>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb336-1" aria-hidden="true" tabindex="-1"></a>dt[, height_meters <span class="sc">:</span><span class="er">=</span> height<span class="sc">/</span><span class="dv">100</span>]</span></code></pre></div>
<p>Теперь у нас в дата.тейбле есть колонка <code>height_meters</code>, в которой хранится рост каждого испытуемого в метрах (то есть, 165 см превращается в 1.65 м). Обратите внимание - я не фильтровала строки, перед первой запятой ничего нет. Но <em>поставить</em> её надо, чтобы дата.тейбл понял, что вы пишете код <code>height_meters := height/100</code> во втором компоненте.</p>
<p>Но и это не самое клёвое! Ведь у нас есть третья часть (следите за руками - это часть после двух запятых). В третьей части мы можем указать, по какой колонке <em>сгруппировать</em> данные. Следующая строчка исключит всех респондентов, у которых больше двух глаз, и посчитает среднюю длину волос для каждого факультета:</p>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="фильтрация-строк-и-столбцов-в-base-r-введение-в-data-table.html#cb337-1" aria-hidden="true" tabindex="-1"></a>dt[eye_number <span class="sc">&lt;=</span> <span class="dv">2</span>, <span class="fu">mean</span>(hair_length), by <span class="ot">=</span> hogwarts]</span></code></pre></div>
<div data-pagedtable="false">
<script data-pagedtable-source type="application/json">
{"columns":[{"label":["hogwarts"],"name":[1],"type":["chr"],"align":["left"]},{"label":["V1"],"name":[2],"type":["dbl"],"align":["right"]}],"data":[{"1":"Hufflepuff","2":"16.50000"},{"1":"Gryffindor","2":"27.57143"},{"1":"Slytherin","2":"24.33333"},{"1":"Ravenclaw","2":"19.72727"}],"options":{"columns":{"min":{},"max":[10]},"rows":{"min":[10],"max":[10]},"pages":{}}}
  </script>
</div>
<div class="rmdtask">
<p>
Задание: Найдите самого высокого человека, родившегося в каждый из месяцев. Тех, кто в вопросе про месяцы указал “Я не рождался(-лась)”, исключите из подсчётов.
</p>
<p>
Подсказка: функция <code>max()</code> выдаст NA для одного из месяцев, потому что кто-то не ответил на вопрос о росте. Исключите NA из подсчётов: <code>max(height, na.rm = TRUE)</code>. <code>na.rm</code> значит NA remove - то бишь, убирать ли NA при поиске максимального значения.
</p>
</div>
<div class="rmdtask">
<p>
Задание: С помощью функции <code>sum()</code> узнайте, сколько суммарно братьев и сестёр у всех голубоглазых. А сколько у всех зеленоглазых? Найдите оба ответа одной строчкой кода :)
</p>
</div>
<div class="rmdtask">
<p>
Задание: Какой средний размер обуви у тех, кто выбрал чай (а не кофе или потанцевать)?
</p>
</div>
<p>Если у вас есть вопросы про эту главу, скорее задайте их в канале #day1-afternoon-filter. Если после выполнения заданий у вас остались время и силы, вы можете воспользоваться тем, что мы сегодня прошли, чтобы постараться и найти самые интересные факты о нашем датасете. А если вы устали - идите отдыхать! :) Завтра - больше.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="введение-в-r.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cтатистические-критерии-корреляции.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": false,
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/maria-srv/AnDan2021Start/edit/master/02_index_filter_dt2.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
},
"self_contained": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
